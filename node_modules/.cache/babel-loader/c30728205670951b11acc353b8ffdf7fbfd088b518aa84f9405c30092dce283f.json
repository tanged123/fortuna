{"ast":null,"code":"import React,{useState,useMemo,useRef,useCallback}from'react';import{sankey,sankeyJustify,sankeyLinkHorizontal}from'd3-sankey';import{scaleOrdinal}from'd3-scale';import{formatCurrency}from'../utils/csvParser';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SankeyChart=_ref=>{let{data}=_ref;const[hoveredNode,setHoveredNode]=useState(null);const[hoveredLink,setHoveredLink]=useState(null);const[zoom,setZoom]=useState(1);const[pan,setPan]=useState({x:0,y:0});const[isDragging,setIsDragging]=useState(false);const[dragStart,setDragStart]=useState({x:0,y:0});const svgRef=useRef(null);// Generate Sankey data from financial data\nconst sankeyData=useMemo(()=>{const nodes=[];const links=[];// Add income node\nnodes.push({name:'Monthly Income',category:'income'});// Add expense nodes and links\ndata.expenses.forEach(expense=>{const categoryKey=expense.category.toLowerCase().replace(/[^a-z]/g,'');nodes.push({name:expense.category,category:categoryKey});links.push({source:'Monthly Income',target:expense.category,value:expense.amount});});// Add savings node and link\nif(data.savings>0){nodes.push({name:'Savings',category:'savings'});links.push({source:'Monthly Income',target:'Savings',value:data.savings});}return{nodes,links};},[data]);// Chart dimensions\nconst MARGIN_Y=25;const MARGIN_X=5;const containerWidth=900;const containerHeight=600;// Color scale\nconst allGroups=[...new Set(sankeyData.nodes.map(d=>d.category))].sort();const COLORS=[\"#10B981\",\"#EF4444\",\"#F59E0B\",\"#8B5CF6\",\"#EC4899\",\"#6B7280\",\"#F97316\",\"#84CC16\",\"#06B6D4\",\"#F43F5E\",\"#A855F7\",\"#64748B\",\"#3B82F6\"];const colorScale=scaleOrdinal().domain(allGroups).range(COLORS);// Set up the sankey diagram properties\nconst sankeyGenerator=sankey().nodeWidth(26).nodePadding(10).extent([[MARGIN_X,MARGIN_Y],[containerWidth-MARGIN_X,containerHeight-MARGIN_Y]]).nodeId(node=>node.name).nodeAlign(sankeyJustify);// Compute nodes and links positions\nconst{nodes,links}=sankeyGenerator(sankeyData);// Pan and zoom handlers\nconst handleWheel=useCallback(e=>{e.preventDefault();const delta=e.deltaY>0?0.9:1.1;const newZoom=Math.max(0.1,Math.min(3,zoom*delta));setZoom(newZoom);},[zoom]);const handleMouseDown=useCallback(e=>{if(e.button===0){// Left mouse button\nsetIsDragging(true);setDragStart({x:e.clientX-pan.x,y:e.clientY-pan.y});}},[pan]);const handleMouseMove=useCallback(e=>{if(isDragging){setPan({x:e.clientX-dragStart.x,y:e.clientY-dragStart.y});}},[isDragging,dragStart]);const handleMouseUp=useCallback(()=>{setIsDragging(false);},[]);const resetView=useCallback(()=>{setZoom(1);setPan({x:0,y:0});},[]);// Touch support for mobile\nconst handleTouchStart=useCallback(e=>{if(e.touches.length===1){const touch=e.touches[0];setIsDragging(true);setDragStart({x:touch.clientX-pan.x,y:touch.clientY-pan.y});}},[pan]);const handleTouchMove=useCallback(e=>{if(isDragging&&e.touches.length===1){const touch=e.touches[0];setPan({x:touch.clientX-dragStart.x,y:touch.clientY-dragStart.y});}},[isDragging,dragStart]);const handleTouchEnd=useCallback(()=>{setIsDragging(false);},[]);// Render nodes\nconst allNodes=nodes.map(node=>{return/*#__PURE__*/_jsx(\"g\",{children:/*#__PURE__*/_jsx(\"rect\",{height:node.y1-node.y0,width:sankeyGenerator.nodeWidth(),x:node.x0,y:node.y0,stroke:\"black\",fill:colorScale(node.category),fillOpacity:1,rx:0.9,className:\"transition-all duration-200 cursor-pointer\",style:{opacity:hoveredNode===node.name?0.9:1,transform:hoveredNode===node.name?'scale(1.02)':'scale(1)'},onMouseEnter:()=>setHoveredNode(node.name),onMouseLeave:()=>setHoveredNode(null)})},node.index);});// Render links\nconst allLinks=links.map((link,i)=>{const linkGenerator=sankeyLinkHorizontal();const path=linkGenerator(link);return/*#__PURE__*/_jsx(\"path\",{d:path,stroke:colorScale(link.source.category),fill:\"none\",strokeOpacity:hoveredLink===i?0.8:0.3,strokeWidth:link.width,className:\"transition-all duration-200 cursor-pointer\",onMouseEnter:()=>setHoveredLink(i),onMouseLeave:()=>setHoveredLink(null)},i);});// Render labels\nconst allLabels=nodes.map((node,i)=>{return/*#__PURE__*/_jsx(\"text\",{x:node.x0<containerWidth/2?node.x1+6:node.x0-6,y:(node.y1+node.y0)/2,dy:\"0.35rem\",textAnchor:node.x0<containerWidth/2?\"start\":\"end\",fontSize:12,className:\"fill-gray-700 font-medium\",children:node.name},i);});return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-2\",children:\"Money Flow Visualization\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"See how your monthly income flows into expenses and savings\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setZoom(Math.max(0.1,zoom-0.1)),className:\"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded border\",children:\"Zoom Out\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setZoom(Math.min(3,zoom+0.1)),className:\"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded border\",children:\"Zoom In\"}),/*#__PURE__*/_jsx(\"button\",{onClick:resetView,className:\"px-3 py-1 text-sm bg-blue-100 hover:bg-blue-200 text-blue-700 rounded border\",children:\"Reset View\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[\"Zoom: \",Math.round(zoom*100),\"% | Scroll to zoom, drag to pan\",/*#__PURE__*/_jsx(\"span\",{className:\"ml-4 text-xs\",children:\"Proper Sankey flow conservation\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border border-gray-200 rounded-lg overflow-hidden\",style:{height:'600px',cursor:isDragging?'grabbing':'grab'},onWheel:handleWheel,onMouseDown:handleMouseDown,onMouseMove:handleMouseMove,onMouseUp:handleMouseUp,onMouseLeave:handleMouseUp,onTouchStart:handleTouchStart,onTouchMove:handleTouchMove,onTouchEnd:handleTouchEnd,children:/*#__PURE__*/_jsxs(\"svg\",{ref:svgRef,width:\"100%\",height:\"100%\",viewBox:\"\".concat(-pan.x,\" \").concat(-pan.y,\" \").concat(containerWidth/zoom,\" \").concat(containerHeight/zoom),style:{minWidth:containerWidth*zoom,minHeight:containerHeight*zoom,transform:\"scale(\".concat(zoom,\")\"),transformOrigin:'0 0'},children:[allLinks,allNodes,allLabels]})})]}),hoveredNode&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute bg-gray-900 text-white px-3 py-2 rounded-lg shadow-lg text-sm z-10 pointer-events-none\",children:(()=>{const node=nodes.find(n=>n.name===hoveredNode);if(!node)return null;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold\",children:node.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-300\",children:formatCurrency(node.value)}),node.name==='Monthly Income'&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-400 mt-1\",children:[data.savingsPercentage.toFixed(1),\"% saved\"]})]});})()}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3\",children:nodes.map(node=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 rounded\",style:{backgroundColor:colorScale(node.category)}}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-600\",children:[node.name,\": \",formatCurrency(node.value)]})]},node.name))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-600\",children:formatCurrency(data.monthlyNetIncome)}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Total Income\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-red-600\",children:formatCurrency(data.totalExpenses)}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Total Expenses\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:formatCurrency(data.savings)}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[\"Savings (\",data.savingsPercentage.toFixed(1),\"%)\"]})]})]})]});};export default SankeyChart;","map":{"version":3,"names":["React","useState","useMemo","useRef","useCallback","sankey","sankeyJustify","sankeyLinkHorizontal","scaleOrdinal","formatCurrency","jsx","_jsx","jsxs","_jsxs","SankeyChart","_ref","data","hoveredNode","setHoveredNode","hoveredLink","setHoveredLink","zoom","setZoom","pan","setPan","x","y","isDragging","setIsDragging","dragStart","setDragStart","svgRef","sankeyData","nodes","links","push","name","category","expenses","forEach","expense","categoryKey","toLowerCase","replace","source","target","value","amount","savings","MARGIN_Y","MARGIN_X","containerWidth","containerHeight","allGroups","Set","map","d","sort","COLORS","colorScale","domain","range","sankeyGenerator","nodeWidth","nodePadding","extent","nodeId","node","nodeAlign","handleWheel","e","preventDefault","delta","deltaY","newZoom","Math","max","min","handleMouseDown","button","clientX","clientY","handleMouseMove","handleMouseUp","resetView","handleTouchStart","touches","length","touch","handleTouchMove","handleTouchEnd","allNodes","children","height","y1","y0","width","x0","stroke","fill","fillOpacity","rx","className","style","opacity","transform","onMouseEnter","onMouseLeave","index","allLinks","link","i","linkGenerator","path","strokeOpacity","strokeWidth","allLabels","x1","dy","textAnchor","fontSize","onClick","round","cursor","onWheel","onMouseDown","onMouseMove","onMouseUp","onTouchStart","onTouchMove","onTouchEnd","ref","viewBox","concat","minWidth","minHeight","transformOrigin","find","n","savingsPercentage","toFixed","backgroundColor","monthlyNetIncome","totalExpenses"],"sources":["/home/tanged/repo/Fortuna/src/components/SankeyChart.tsx"],"sourcesContent":["import React, { useState, useMemo, useRef, useCallback } from 'react';\nimport { sankey, sankeyJustify, sankeyLinkHorizontal } from 'd3-sankey';\nimport { scaleOrdinal } from 'd3-scale';\nimport { ParsedFinancialData } from '../types/finance';\nimport { formatCurrency } from '../utils/csvParser';\n\ninterface SankeyChartProps {\n  data: ParsedFinancialData;\n}\n\ninterface SankeyNode {\n  name: string;\n  category: string;\n}\n\ninterface SankeyLink {\n  source: string;\n  target: string;\n  value: number;\n}\n\ninterface SankeyData {\n  nodes: SankeyNode[];\n  links: SankeyLink[];\n}\n\nconst SankeyChart: React.FC<SankeyChartProps> = ({ data }) => {\n  const [hoveredNode, setHoveredNode] = useState<string | null>(null);\n  const [hoveredLink, setHoveredLink] = useState<number | null>(null);\n  const [zoom, setZoom] = useState(1);\n  const [pan, setPan] = useState({ x: 0, y: 0 });\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n  const svgRef = useRef<SVGSVGElement>(null);\n\n  // Generate Sankey data from financial data\n  const sankeyData = useMemo((): SankeyData => {\n    const nodes: SankeyNode[] = [];\n    const links: SankeyLink[] = [];\n\n    // Add income node\n    nodes.push({\n      name: 'Monthly Income',\n      category: 'income'\n    });\n\n    // Add expense nodes and links\n    data.expenses.forEach((expense) => {\n      const categoryKey = expense.category.toLowerCase().replace(/[^a-z]/g, '');\n      \n      nodes.push({\n        name: expense.category,\n        category: categoryKey\n      });\n\n      links.push({\n        source: 'Monthly Income',\n        target: expense.category,\n        value: expense.amount\n      });\n    });\n\n    // Add savings node and link\n    if (data.savings > 0) {\n      nodes.push({\n        name: 'Savings',\n        category: 'savings'\n      });\n\n      links.push({\n        source: 'Monthly Income',\n        target: 'Savings',\n        value: data.savings\n      });\n    }\n\n    return { nodes, links };\n  }, [data]);\n\n  // Chart dimensions\n  const MARGIN_Y = 25;\n  const MARGIN_X = 5;\n  const containerWidth = 900;\n  const containerHeight = 600;\n  \n  // Color scale\n  const allGroups = [...new Set(sankeyData.nodes.map((d) => d.category))].sort();\n  const COLORS = [\"#10B981\", \"#EF4444\", \"#F59E0B\", \"#8B5CF6\", \"#EC4899\", \"#6B7280\", \"#F97316\", \"#84CC16\", \"#06B6D4\", \"#F43F5E\", \"#A855F7\", \"#64748B\", \"#3B82F6\"];\n  const colorScale = scaleOrdinal<string>().domain(allGroups).range(COLORS);\n\n  // Set up the sankey diagram properties\n  const sankeyGenerator = sankey()\n    .nodeWidth(26)\n    .nodePadding(10)\n    .extent([\n      [MARGIN_X, MARGIN_Y],\n      [containerWidth - MARGIN_X, containerHeight - MARGIN_Y],\n    ])\n    .nodeId((node: any) => node.name)\n    .nodeAlign(sankeyJustify);\n\n  // Compute nodes and links positions\n  const { nodes, links } = sankeyGenerator(sankeyData as any);\n\n  // Pan and zoom handlers\n  const handleWheel = useCallback((e: React.WheelEvent) => {\n    e.preventDefault();\n    const delta = e.deltaY > 0 ? 0.9 : 1.1;\n    const newZoom = Math.max(0.1, Math.min(3, zoom * delta));\n    setZoom(newZoom);\n  }, [zoom]);\n\n  const handleMouseDown = useCallback((e: React.MouseEvent) => {\n    if (e.button === 0) { // Left mouse button\n      setIsDragging(true);\n      setDragStart({ x: e.clientX - pan.x, y: e.clientY - pan.y });\n    }\n  }, [pan]);\n\n  const handleMouseMove = useCallback((e: React.MouseEvent) => {\n    if (isDragging) {\n      setPan({\n        x: e.clientX - dragStart.x,\n        y: e.clientY - dragStart.y\n      });\n    }\n  }, [isDragging, dragStart]);\n\n  const handleMouseUp = useCallback(() => {\n    setIsDragging(false);\n  }, []);\n\n  const resetView = useCallback(() => {\n    setZoom(1);\n    setPan({ x: 0, y: 0 });\n  }, []);\n\n  // Touch support for mobile\n  const handleTouchStart = useCallback((e: React.TouchEvent) => {\n    if (e.touches.length === 1) {\n      const touch = e.touches[0];\n      setIsDragging(true);\n      setDragStart({ x: touch.clientX - pan.x, y: touch.clientY - pan.y });\n    }\n  }, [pan]);\n\n  const handleTouchMove = useCallback((e: React.TouchEvent) => {\n    if (isDragging && e.touches.length === 1) {\n      const touch = e.touches[0];\n      setPan({\n        x: touch.clientX - dragStart.x,\n        y: touch.clientY - dragStart.y\n      });\n    }\n  }, [isDragging, dragStart]);\n\n  const handleTouchEnd = useCallback(() => {\n    setIsDragging(false);\n  }, []);\n\n  // Render nodes\n  const allNodes = nodes.map((node: any) => {\n    return (\n      <g key={node.index}>\n        <rect\n          height={node.y1 - node.y0}\n          width={sankeyGenerator.nodeWidth()}\n          x={node.x0}\n          y={node.y0}\n          stroke={\"black\"}\n          fill={colorScale(node.category)}\n          fillOpacity={1}\n          rx={0.9}\n          className=\"transition-all duration-200 cursor-pointer\"\n          style={{\n            opacity: hoveredNode === node.name ? 0.9 : 1,\n            transform: hoveredNode === node.name ? 'scale(1.02)' : 'scale(1)',\n          }}\n          onMouseEnter={() => setHoveredNode(node.name)}\n          onMouseLeave={() => setHoveredNode(null)}\n        />\n      </g>\n    );\n  });\n\n  // Render links\n  const allLinks = links.map((link: any, i: number) => {\n    const linkGenerator = sankeyLinkHorizontal();\n    const path = linkGenerator(link);\n\n    return (\n      <path\n        key={i}\n        d={path}\n        stroke={colorScale(link.source.category)}\n        fill=\"none\"\n        strokeOpacity={hoveredLink === i ? 0.8 : 0.3}\n        strokeWidth={link.width}\n        className=\"transition-all duration-200 cursor-pointer\"\n        onMouseEnter={() => setHoveredLink(i)}\n        onMouseLeave={() => setHoveredLink(null)}\n      />\n    );\n  });\n\n  // Render labels\n  const allLabels = nodes.map((node: any, i: number) => {\n    return (\n      <text\n        key={i}\n        x={node.x0 < containerWidth / 2 ? node.x1 + 6 : node.x0 - 6}\n        y={(node.y1 + node.y0) / 2}\n        dy=\"0.35rem\"\n        textAnchor={node.x0 < containerWidth / 2 ? \"start\" : \"end\"}\n        fontSize={12}\n        className=\"fill-gray-700 font-medium\"\n      >\n        {node.name}\n      </text>\n    );\n  });\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 relative\">\n      <div className=\"mb-6\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n          Money Flow Visualization\n        </h3>\n        <p className=\"text-sm text-gray-600\">\n          See how your monthly income flows into expenses and savings\n        </p>\n      </div>\n\n      <div className=\"relative\">\n        {/* Controls */}\n        <div className=\"mb-4 flex justify-between items-center\">\n          <div className=\"flex space-x-2\">\n            <button\n              onClick={() => setZoom(Math.max(0.1, zoom - 0.1))}\n              className=\"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded border\"\n            >\n              Zoom Out\n            </button>\n            <button\n              onClick={() => setZoom(Math.min(3, zoom + 0.1))}\n              className=\"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded border\"\n            >\n              Zoom In\n            </button>\n            <button\n              onClick={resetView}\n              className=\"px-3 py-1 text-sm bg-blue-100 hover:bg-blue-200 text-blue-700 rounded border\"\n            >\n              Reset View\n            </button>\n          </div>\n          <div className=\"text-sm text-gray-600\">\n            Zoom: {Math.round(zoom * 100)}% | Scroll to zoom, drag to pan\n            <span className=\"ml-4 text-xs\">\n              Proper Sankey flow conservation\n            </span>\n          </div>\n        </div>\n\n        {/* Chart Container */}\n        <div \n          className=\"border border-gray-200 rounded-lg overflow-hidden\"\n          style={{ height: '600px', cursor: isDragging ? 'grabbing' : 'grab' }}\n          onWheel={handleWheel}\n          onMouseDown={handleMouseDown}\n          onMouseMove={handleMouseMove}\n          onMouseUp={handleMouseUp}\n          onMouseLeave={handleMouseUp}\n          onTouchStart={handleTouchStart}\n          onTouchMove={handleTouchMove}\n          onTouchEnd={handleTouchEnd}\n        >\n          <svg\n            ref={svgRef}\n            width=\"100%\"\n            height=\"100%\"\n            viewBox={`${-pan.x} ${-pan.y} ${containerWidth / zoom} ${containerHeight / zoom}`}\n            style={{ \n              minWidth: containerWidth * zoom, \n              minHeight: containerHeight * zoom,\n              transform: `scale(${zoom})`,\n              transformOrigin: '0 0'\n            }}\n          >\n            {allLinks}\n            {allNodes}\n            {allLabels}\n          </svg>\n        </div>\n      </div>\n\n      {/* Tooltip */}\n      {hoveredNode && (\n        <div className=\"absolute bg-gray-900 text-white px-3 py-2 rounded-lg shadow-lg text-sm z-10 pointer-events-none\">\n          {(() => {\n            const node = nodes.find((n: any) => n.name === hoveredNode);\n            if (!node) return null;\n            return (\n              <div>\n                <div className=\"font-semibold\">{node.name}</div>\n                <div className=\"text-gray-300\">{formatCurrency(node.value)}</div>\n                {node.name === 'Monthly Income' && (\n                  <div className=\"text-xs text-gray-400 mt-1\">\n                    {data.savingsPercentage.toFixed(1)}% saved\n                  </div>\n                )}\n              </div>\n            );\n          })()}\n        </div>\n      )}\n\n      {/* Legend */}\n      <div className=\"mt-6 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3\">\n        {nodes.map((node: any) => (\n          <div key={node.name} className=\"flex items-center space-x-2\">\n            <div\n              className=\"w-3 h-3 rounded\"\n              style={{ backgroundColor: colorScale(node.category) }}\n            />\n            <span className=\"text-xs text-gray-600\">\n              {node.name}: {formatCurrency(node.value)}\n            </span>\n          </div>\n        ))}\n      </div>\n\n      {/* Summary Stats */}\n      <div className=\"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gray-50 rounded-lg\">\n        <div className=\"text-center\">\n          <div className=\"text-2xl font-bold text-green-600\">\n            {formatCurrency(data.monthlyNetIncome)}\n          </div>\n          <div className=\"text-sm text-gray-600\">Total Income</div>\n        </div>\n        <div className=\"text-center\">\n          <div className=\"text-2xl font-bold text-red-600\">\n            {formatCurrency(data.totalExpenses)}\n          </div>\n          <div className=\"text-sm text-gray-600\">Total Expenses</div>\n        </div>\n        <div className=\"text-center\">\n          <div className=\"text-2xl font-bold text-blue-600\">\n            {formatCurrency(data.savings)}\n          </div>\n          <div className=\"text-sm text-gray-600\">Savings ({data.savingsPercentage.toFixed(1)}%)</div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SankeyChart;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}